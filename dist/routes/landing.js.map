{"version":3,"sources":["../../routes/landing.js"],"names":["express","require","router","Router","Data","User","middleware","get","isLoggedIn","req","res","find","err","data","sandroData","meti","khvedelaData","iashaData","bojaData","abuashviliData","likaData","mariData","baqroData","forEach","packs","author","fullname","pack","send","limit","sort","exec","allData","scores","sandro","khvedelidze","iasha","boja","abuashvili","lika","mari","baqro","render","findById","user","_id","post","obj","body","id","create","result","redirect","delete","findByIdAndRemove","params","module","exports"],"mappings":"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","file":"landing.js","sourcesContent":["const express = require(\"express\");\nconst router = express.Router();\nconst Data = require(\"../models/data\");\nconst User = require('../models/user');\nconst middleware = require('../middleware');\n\nrouter.get('/home', middleware.isLoggedIn, (req, res) => {\n  Data.find({}, function(err, data){\n     const sandroData = {meti: 0, data: 0};\n     const khvedelaData = {meti: 0, data: 0};\n     const iashaData = {meti: 0, data: 0};\n     const bojaData = {meti: 0, data: 0};\n     const abuashviliData = {meti: 0, data: 0};\n     const likaData = {meti: 0, data: 0};\n     const mariData = {meti: 0, data: 0};\n     const baqroData = {meti: 0, data: 0};\n\n     data.forEach(function (packs) {\n         if(packs.author.fullname === 'Sandro Suladze'){\n            sandroData.data = sandroData.data + 1;\n            if(packs.pack === 'METI 25'){\n              sandroData.meti = sandroData.meti + 1;\n            }\n         }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Davit Khvedelidze'){\n           khvedelaData.data = khvedelaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              khvedelaData.meti = khvedelaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Salo Iashvili'){\n           iashaData.data = iashaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              iashaData.meti = iashaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Salome Bozhadze'){\n           bojaData.data = bojaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              bojaData.meti = bojaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Tornike Abuashvili'){\n           abuashviliData.data = abuashviliData.data + 1;\n           if(packs.pack === 'METI 25'){\n              abuashviliData.meti = abuashviliData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Lika Maisuradze'){\n           likaData.data = likaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              likaData.meti = likaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Mariam Misabishvili'){\n           mariData.data = mariData.data + 1;\n           if(packs.pack === 'METI 25'){\n              mariData.meti = mariData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Tamar Bakradze'){\n           baqroData.data = baqroData.data + 1;\n           if(packs.pack === 'METI 25'){\n              baqroData.meti = baqroData.meti + 1;\n           }\n        }\n     });\n\n     if(err){\n       return res.send(err)\n         }\n     Data.find({}).limit(40).sort('-date').exec((err, allData) => {\n        if(err){\n           res.send(err)\n        }else{\n           let scores = {};\n               scores.sandro = sandroData;\n               scores.khvedelidze = khvedelaData;\n               scores.iasha = iashaData;\n               scores.boja = bojaData;\n               scores.abuashvili = abuashviliData;\n               scores.lika = likaData;\n               scores.mari = mariData;\n               scores.baqro = baqroData;\n           res.render('landing', {allData: allData, scores: scores})\n        }\n     });\n       });\n});\n\nrouter.get('/home/:id', (req, res) => {\n   User.findById(req.user._id, (err, user) =>{\n      if(err){\n         res.send(err)\n      }else{\n         Data.find({'author.fullname': user.fullname}, (err, data) => {\n            if(err){\n               res.send(err)\n            }else{\n               res.render('myData', {data: data})\n            }\n         })\n      }\n   })\n});\n\nrouter.post('/addData', (req, res) => {\n    const obj = req.body.data;\n    obj.author = {\n        fullname: req.user.fullname,\n        id: req.user._id\n  };\n    Data.create(obj, (err, result) => {\n        if(err){\n            res.send(err)\n        }else{\n            res.redirect('/home');\n        }\n    });\n});\n\n\nrouter.delete('/data-delete/:id', (req, res) => {\n    Data.findByIdAndRemove(req.params.id, (err, result) => {\n        if(err){\n            return res.send(err)\n        }\n        res.redirect('/home')\n    });\n});\n\n\nmodule.exports = router;"]}