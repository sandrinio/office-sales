{"version":3,"sources":["../../routes/landing.js"],"names":["express","require","router","Router","Data","User","get","req","res","find","err","data","sandroData","meti","khvedelaData","iashaData","bojaData","abuashviliData","likaData","mariData","baqroData","forEach","packs","author","fullname","pack","send","limit","sort","exec","allData","scores","sandro","khvedelidze","iasha","boja","abuashvili","lika","mari","baqro","render","post","obj","body","user","id","_id","create","result","redirect","delete","findByIdAndRemove","params","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,OAAOH,QAAQ,gBAAR,CAAb;AACA,IAAMI,OAAOJ,QAAQ,gBAAR,CAAb;;AAEAC,OAAOI,GAAP,CAAW,OAAX,EAAoB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChCJ,QAAKK,IAAL,CAAU,EAAV,EAAc,UAASC,GAAT,EAAcC,IAAd,EAAmB;AAC9B,UAAMC,aAAa,EAACC,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAnB;AACA,UAAMG,eAAe,EAACD,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAArB;AACA,UAAMI,YAAY,EAACF,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAlB;AACA,UAAMK,WAAW,EAACH,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAjB;AACA,UAAMM,iBAAiB,EAACJ,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAvB;AACA,UAAMO,WAAW,EAACL,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAjB;AACA,UAAMQ,WAAW,EAACN,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAjB;AACA,UAAMS,YAAY,EAACP,MAAM,CAAP,EAAUF,MAAM,CAAhB,EAAlB;;AAEAA,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC1B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,gBAA7B,EAA8C;AAC3CZ,uBAAWD,IAAX,GAAkBC,WAAWD,IAAX,GAAkB,CAApC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AAC1Bb,0BAAWC,IAAX,GAAkBD,WAAWC,IAAX,GAAkB,CAApC;AACD;AACH;AACJ,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,mBAA7B,EAAiD;AAC9CV,yBAAaH,IAAb,GAAoBG,aAAaH,IAAb,GAAoB,CAAxC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBX,4BAAaD,IAAb,GAAoBC,aAAaD,IAAb,GAAoB,CAAxC;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,eAA7B,EAA6C;AAC1CT,sBAAUJ,IAAV,GAAiBI,UAAUJ,IAAV,GAAiB,CAAlC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBV,yBAAUF,IAAV,GAAiBE,UAAUF,IAAV,GAAiB,CAAlC;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,iBAA7B,EAA+C;AAC5CR,qBAASL,IAAT,GAAgBK,SAASL,IAAT,GAAgB,CAAhC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBT,wBAASH,IAAT,GAAgBG,SAASH,IAAT,GAAgB,CAAhC;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,oBAA7B,EAAkD;AAC/CP,2BAAeN,IAAf,GAAsBM,eAAeN,IAAf,GAAsB,CAA5C;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBR,8BAAeJ,IAAf,GAAsBI,eAAeJ,IAAf,GAAsB,CAA5C;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,iBAA7B,EAA+C;AAC5CN,qBAASP,IAAT,GAAgBO,SAASP,IAAT,GAAgB,CAAhC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBP,wBAASL,IAAT,GAAgBK,SAASL,IAAT,GAAgB,CAAhC;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,qBAA7B,EAAmD;AAChDL,qBAASR,IAAT,GAAgBQ,SAASR,IAAT,GAAgB,CAAhC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBN,wBAASN,IAAT,GAAgBM,SAASN,IAAT,GAAgB,CAAhC;AACF;AACH;AACH,OAPD;AAQAF,WAAKU,OAAL,CAAa,UAAUC,KAAV,EAAiB;AAC3B,aAAGA,MAAMC,MAAN,CAAaC,QAAb,KAA0B,gBAA7B,EAA8C;AAC3CJ,sBAAUT,IAAV,GAAiBS,UAAUT,IAAV,GAAiB,CAAlC;AACA,gBAAGW,MAAMG,IAAN,KAAe,SAAlB,EAA4B;AACzBL,yBAAUP,IAAV,GAAiBO,UAAUP,IAAV,GAAiB,CAAlC;AACF;AACH;AACH,OAPD;;AASA,UAAGH,GAAH,EAAO;AACL,gBAAOF,IAAIkB,IAAJ,CAAShB,GAAT,CAAP;AACG;AACLN,WAAKK,IAAL,CAAU,EAAV,EAAckB,KAAd,CAAoB,EAApB,EAAwBC,IAAxB,CAA6B,OAA7B,EAAsCC,IAAtC,CAA2C,UAACnB,GAAD,EAAMoB,OAAN,EAAkB;AAC1D,aAAGpB,GAAH,EAAO;AACJF,gBAAIkB,IAAJ,CAAShB,GAAT;AACF,UAFD,MAEK;AACF,gBAAIqB,SAAS,EAAb;AACAA,mBAAOC,MAAP,GAAgBpB,UAAhB;AACAmB,mBAAOE,WAAP,GAAqBnB,YAArB;AACAiB,mBAAOG,KAAP,GAAenB,SAAf;AACAgB,mBAAOI,IAAP,GAAcnB,QAAd;AACAe,mBAAOK,UAAP,GAAoBnB,cAApB;AACAc,mBAAOM,IAAP,GAAcnB,QAAd;AACAa,mBAAOO,IAAP,GAAcnB,QAAd;AACAY,mBAAOQ,KAAP,GAAenB,SAAf;AACAZ,gBAAIgC,MAAJ,CAAW,SAAX,EAAsB,EAACV,SAASA,OAAV,EAAmBC,QAAQA,MAA3B,EAAtB;AACF;AACH,OAfD;AAgBG,IA9FN;AA+FD,CAhGD;;AAkGA7B,OAAOuC,IAAP,CAAY,UAAZ,EAAwB,UAAClC,GAAD,EAAMC,GAAN,EAAc;AAClC,OAAMkC,MAAMnC,IAAIoC,IAAJ,CAAShC,IAArB;AACA+B,OAAInB,MAAJ,GAAa;AACTC,gBAAUjB,IAAIqC,IAAJ,CAASpB,QADV;AAETqB,UAAItC,IAAIqC,IAAJ,CAASE;AAFJ,IAAb;;AAKA1C,QAAK2C,MAAL,CAAYL,GAAZ,EAAiB,UAAChC,GAAD,EAAMsC,MAAN,EAAiB;AAC9B,UAAGtC,GAAH,EAAO;AACHF,aAAIkB,IAAJ,CAAShB,GAAT;AACH,OAFD,MAEK;AACDF,aAAIyC,QAAJ,CAAa,OAAb;AACH;AACJ,IAND;AAOH,CAdD;;AAiBA/C,OAAOgD,MAAP,CAAc,kBAAd,EAAkC,UAAC3C,GAAD,EAAMC,GAAN,EAAc;AAC5CJ,QAAK+C,iBAAL,CAAuB5C,IAAI6C,MAAJ,CAAWP,EAAlC,EAAsC,UAACnC,GAAD,EAAMsC,MAAN,EAAiB;AACnD,UAAGtC,GAAH,EAAO;AACH,gBAAOF,IAAIkB,IAAJ,CAAShB,GAAT,CAAP;AACH;AACDF,UAAIyC,QAAJ,CAAa,OAAb;AACH,IALD;AAMH,CAPD;;AAUAI,OAAOC,OAAP,GAAiBpD,MAAjB","file":"landing.js","sourcesContent":["const express = require(\"express\");\nconst router = express.Router();\nconst Data = require(\"../models/data\");\nconst User = require('../models/user');\n\nrouter.get('/home', (req, res) => {\n  Data.find({}, function(err, data){\n     const sandroData = {meti: 0, data: 0};\n     const khvedelaData = {meti: 0, data: 0};\n     const iashaData = {meti: 0, data: 0};\n     const bojaData = {meti: 0, data: 0};\n     const abuashviliData = {meti: 0, data: 0};\n     const likaData = {meti: 0, data: 0};\n     const mariData = {meti: 0, data: 0};\n     const baqroData = {meti: 0, data: 0};\n\n     data.forEach(function (packs) {\n         if(packs.author.fullname === 'Sandro Suladze'){\n            sandroData.data = sandroData.data + 1;\n            if(packs.pack === 'METI 25'){\n              sandroData.meti = sandroData.meti + 1;\n            }\n         }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Davit Khvedelidze'){\n           khvedelaData.data = khvedelaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              khvedelaData.meti = khvedelaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Salo Iashvili'){\n           iashaData.data = iashaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              iashaData.meti = iashaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Salome Bozhadze'){\n           bojaData.data = bojaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              bojaData.meti = bojaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Tornike Abuashvili'){\n           abuashviliData.data = abuashviliData.data + 1;\n           if(packs.pack === 'METI 25'){\n              abuashviliData.meti = abuashviliData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Lika Maisuradze'){\n           likaData.data = likaData.data + 1;\n           if(packs.pack === 'METI 25'){\n              likaData.meti = likaData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Mariam Misabishvili'){\n           mariData.data = mariData.data + 1;\n           if(packs.pack === 'METI 25'){\n              mariData.meti = mariData.meti + 1;\n           }\n        }\n     });\n     data.forEach(function (packs) {\n        if(packs.author.fullname === 'Tamar Bakradze'){\n           baqroData.data = baqroData.data + 1;\n           if(packs.pack === 'METI 25'){\n              baqroData.meti = baqroData.meti + 1;\n           }\n        }\n     });\n\n     if(err){\n       return res.send(err)\n         }\n     Data.find({}).limit(40).sort('-date').exec((err, allData) => {\n        if(err){\n           res.send(err)\n        }else{\n           let scores = {};\n           scores.sandro = sandroData;\n           scores.khvedelidze = khvedelaData;\n           scores.iasha = iashaData;\n           scores.boja = bojaData;\n           scores.abuashvili = abuashviliData;\n           scores.lika = likaData;\n           scores.mari = mariData;\n           scores.baqro = baqroData;\n           res.render('landing', {allData: allData, scores: scores})\n        }\n     });\n       });\n});\n\nrouter.post('/addData', (req, res) => {\n    const obj = req.body.data;\n    obj.author = {\n        fullname: req.user.fullname,\n        id: req.user._id\n  };\n    \n    Data.create(obj, (err, result) => {\n        if(err){\n            res.send(err)\n        }else{\n            res.redirect('/home');\n        }\n    });\n});\n\n\nrouter.delete('/data-delete/:id', (req, res) => {\n    Data.findByIdAndRemove(req.params.id, (err, result) => {\n        if(err){\n            return res.send(err)\n        }\n        res.redirect('/home')\n    });\n});\n\n\nmodule.exports = router;"]}